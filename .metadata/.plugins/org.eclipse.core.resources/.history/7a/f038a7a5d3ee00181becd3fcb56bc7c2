package negocio;

import java.sql.*;
import java.util.ArrayList;

import conexion.Conexion;
import entidades.Proveedor;

public class NegocioProveedor {
	
	private Connection con;
	private CallableStatement cstm;
	private PreparedStatement pst;
	private Statement st;
	private String sql = "";
	private ResultSet rs;
	
	
	public ArrayList<Proveedor> Listar(){
		ArrayList<Proveedor> lista = new ArrayList<Proveedor>();
		
		sql = "SELECT ID, Rz_Social, Representante, Email, Telefono, Direccion  FROM Proveedor";
		
		try {
			con = Conexion.Conectar();
			st = con.createStatement();
			rs = st.executeQuery(sql);
			while(rs.next()){
				lista.add(new Proveedor(
						rs.getString("ID"), 
						rs.getString("Rz_Social"), 
						rs.getString("Representante"), 
						rs.getString("Email"), 
						rs.getString("Telefono"), 
						rs.getString("Direccion")
						));
			}
		} catch (Exception ex) {
			ex.printStackTrace();
		} finally{
			try {
				if(rs != null) rs.close();
				if(st != null) st.close();
				if(con != null) con.close();
			} catch (Exception ex) {
				ex.printStackTrace();
			}
		}
		
		return lista;
	}
	
	public boolean InsertarProveedor(Proveedor p){
		boolean exito = false;
		
		sql = "{call USP_ProveedorMantenimiento(?,?,?,?,?,?,?)}";
		
		try {
			con = Conexion.Conectar();
			cstm = con.prepareCall(sql);
			cstm.setString(1, "1");
			cstm.setString(2, p.getID());
			cstm.setString(3, p.getRaz_Soc());
			cstm.setString(4, p.getRepresentante());
			cstm.setString(5, p.getEmail());
			cstm.setString(6, p.getTelf());
			cstm.setString(7, p.getDireccion());
		} catch (Exception ex) {
			ex.printStackTrace();
		} finally{
			try {
				if(cstm != null) cstm.close();
				if(con != null) con.close();
			} catch (Exception ex) {
				ex.printStackTrace();
			}
		}
		
		return exito;
	}
}
